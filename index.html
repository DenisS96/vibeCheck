<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>VibeCheck Pro</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & Babel -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes pulse-gold { 0% { box-shadow: 0 0 0 0 rgba(234, 179, 8, 0.4); } 70% { box-shadow: 0 0 0 15px rgba(234, 179, 8, 0); } 100% { box-shadow: 0 0 0 0 rgba(234, 179, 8, 0); } }
        
        .animate-slide-up { animation: slideUp 0.3s ease-out; }
        .animate-fade-in { animation: fadeIn 0.4s ease-out; }
        .pulse-gold { animation: pulse-gold 2s infinite; }
        
        body { 
            -webkit-tap-highlight-color: transparent; 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #e2e8f0; 
            user-select: none;
            overscroll-behavior-y: contain;
        }
        
        /* App container die op desktop smal blijft */
        .app-container {
            max-width: 450px;
            margin: 0 auto;
            background-color: #f8fafc;
            min-height: 100vh;
            position: relative;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        }

        .safe-bottom { padding-bottom: env(safe-area-inset-bottom); }
        .card-shadow { box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.05), 0 8px 10px -6px rgba(0, 0, 0, 0.05); }
        main { height: calc(100vh - 140px); overflow-y: auto; }
    </style>
</head>
<body class="overflow-hidden">
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js";
        import { getFirestore, doc, setDoc, onSnapshot, updateDoc, arrayUnion, getDoc } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-firestore.js";
        import { getAuth, signInAnonymously, onAuthStateChanged, linkWithPopup, GoogleAuthProvider } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-auth.js";

        // Firebase Config
        const firebaseConfig = {
            apiKey: "AIzaSyAZPIbmsy48MjRGElG7BpNxyiR9ydlvl-k",
            authDomain: "vibecheck-4f630.firebaseapp.com",
            projectId: "vibecheck-4f630",
            storageBucket: "vibecheck-4f630.firebasestorage.app",
            messagingSenderId: "995143530772",
            appId: "1:995143530772:web:f2aedbd148a51170d46a01",
            measurementId: "G-5VP59GQVE0"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const appId = "vibecheck-production";
        const TMDB_BEARER_TOKEN = "eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIxYWYzYWIzYzk1NTk0MmM5YjA3ZmQyYmU5NGFhYjk1MCIsIm5iZiI6MTc2NjY2MjkxOC4wNDQsInN1YiI6IjY5NGQyMzA2YzQxZDgxZDE5NjA3MjgzZSIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.nGJ_aApJYY2CMY7BdTubYCjXxsYYZOt4_2LHiXgEUJc";

        const { useState, useEffect } = React;

        const Icon = ({ name, size = 24, className = "", fill = "none" }) => {
            const icons = {
                heart: <path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.505 4.046 3 5.5L12 21l7-7z" />,
                x: <path d="M18 6 6 18M6 6l12 12" />,
                utensils: <><path d="M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2" /><path d="M7 2v20" /><path d="M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7" /></>,
                wallet: <path d="M21 12V7H5a2 2 0 0 1 0-4h14v4M3 5v14a2 2 0 0 0 2 2h16v-5M18 12a2 2 0 0 0 0 4h4v-4Z" />,
                play: <path d="m6 3 14 9-14 9V3z" />,
                ticket: <path d="M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z" />,
                shield: <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" />,
                film: <rect width="18" height="18" x="3" y="3" rx="2" />,
                share: <><path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8" /><polyline points="16 6 12 2 8 6" /><line x1="12" x2="12" y1="2" y2="15" /></>,
                chevronRight: <polyline points="9 18 15 12 9 6" />,
                info: <><circle cx="12" cy="12" r="10" /><path d="M12 16v-4" /><path d="M12 8h.01" /></>,
                scale: <><path d="m16 16 3-8 3 8c-.87.62-1.9.87-3 .87s-2.13-.25-3-.87Z" /><path d="m2 16 3-8 3 8c-.87.62-1.9.87-3 .87s-2.13-.25-3-.87Z" /><path d="M7 21h10" /><path d="M12 3v18" /><path d="M3 7h18" /></>,
                trash: <path d="M3 6h18M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2" />,
                award: <><circle cx="12" cy="8" r="6" /><path d="M15.477 12.89 17 22l-5-3-5 3 1.523-9.11" /></>,
                users: <><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2" /><circle cx="9" cy="7" r="4" /></>
            };
            return (
                <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill={fill} stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round" className={className}>
                    {icons[name] || null}
                </svg>
            );
        };

        function App() {
            const [user, setUser] = useState(null);
            const [isAnonymous, setIsAnonymous] = useState(true);
            const [view, setView] = useState('landing'); 
            const [balance, setBalance] = useState(0);
            const [roomCode, setRoomCode] = useState('');
            const [roomData, setRoomData] = useState(null);
            const [currentIndex, setCurrentIndex] = useState(0);
            const [isWatchingAd, setIsWatchingAd] = useState(false);
            const [vouchers, setVouchers] = useState([]);
            const [lastClaimedCode, setLastClaimedCode] = useState('');
            const [msg, setMsg] = useState(null);

            const showMsg = (text) => {
                setMsg(text);
                setTimeout(() => setMsg(null), 3000);
            };

            useEffect(() => {
                const unsub = onAuthStateChanged(auth, (u) => {
                    if (u) {
                        setUser(u);
                        setIsAnonymous(u.isAnonymous);
                    } else {
                        signInAnonymously(auth);
                    }
                });
                return unsub;
            }, []);

            useEffect(() => {
                if (!user) return;
                const walletRef = doc(db, 'artifacts', appId, 'users', user.uid, 'data', 'wallet');
                const unsubWallet = onSnapshot(walletRef, (snap) => {
                    if (snap.exists()) {
                        setBalance(snap.data().balance || 0);
                        setVouchers(snap.data().vouchers || []);
                    } else {
                        setDoc(walletRef, { balance: 0.00, vouchers: [], createdAt: Date.now() });
                    }
                });

                let unsubRoom = () => {};
                if (roomCode) {
                    const roomRef = doc(db, 'artifacts', appId, 'public', 'data', 'rooms', roomCode);
                    unsubRoom = onSnapshot(roomRef, (snap) => {
                        if (snap.exists()) {
                            const data = snap.data();
                            setRoomData(data);
                            const pCount = data.participants.length;
                            const matchId = Object.keys(data.votes || {}).find(id => data.votes[id].length === pCount && pCount > 1);
                            if (matchId) setView('match');
                        }
                    });
                }
                return () => { unsubWallet(); unsubRoom(); };
            }, [user, roomCode]);

            const handleCreateRoom = async (cat) => {
                showMsg("Opties ophalen...");
                let items = [];
                if (cat === 'movies') {
                    const res = await fetch(`https://api.themoviedb.org/3/movie/popular?language=nl-NL&page=1`, {
                        headers: { Authorization: `Bearer ${TMDB_BEARER_TOKEN}` }
                    });
                    const data = await res.json();
                    items = data.results.slice(0, 15).map(m => ({
                        id: m.id.toString(), name: m.title, desc: m.overview.slice(0, 80) + "...", img: `https://image.tmdb.org/t/p/w500${m.poster_path}`
                    }));
                } else {
                    items = [
                        { id: 'f1', name: 'Sushi Express', desc: 'Verse sushi mix.', img: 'https://images.unsplash.com/photo-1579871494447-9811cf80d66c?w=400' },
                        { id: 'f2', name: 'Pizza Palace', desc: 'Houtoven pizza.', img: 'https://images.unsplash.com/photo-1513104890138-7c749659a591?w=400' }
                    ];
                }
                const code = Math.random().toString(36).substring(2, 7).toUpperCase();
                await setDoc(doc(db, 'artifacts', appId, 'public', 'data', 'rooms', code), {
                    code, category: cat, participants: [user.uid], votes: {}, items, createdAt: Date.now()
                });
                setRoomCode(code);
                setView('lobby');
            };

            const handleJoinRoom = async (code) => {
                if (!code) return;
                const roomRef = doc(db, 'artifacts', appId, 'public', 'data', 'rooms', code.toUpperCase());
                const snap = await getDoc(roomRef);
                if (snap.exists()) {
                    await updateDoc(roomRef, { participants: arrayUnion(user.uid) });
                    setRoomCode(code.toUpperCase());
                    setView('lobby');
                } else { showMsg("Kamer niet gevonden."); }
            };

            const handleVote = async (isLike) => {
                if (window.navigator.vibrate) window.navigator.vibrate(10);
                const items = roomData.items || [];
                if (isLike) {
                    await updateDoc(doc(db, 'artifacts', appId, 'public', 'data', 'rooms', roomCode), { [`votes.${items[currentIndex].id}`]: arrayUnion(user.uid) });
                }
                if (currentIndex < items.length - 1) setCurrentIndex(currentIndex + 1);
                else setView('waiting');
            };

            const handleWatchAd = () => {
                setIsWatchingAd(true);
                setTimeout(async () => {
                    const walletRef = doc(db, 'artifacts', appId, 'users', user.uid, 'data', 'wallet');
                    const snap = await getDoc(walletRef);
                    const currentBal = snap.exists() ? snap.data().balance : balance;
                    await updateDoc(walletRef, { balance: currentBal + 0.15 });
                    setIsWatchingAd(false);
                    showMsg("‚Ç¨0,15 bijgeschreven!");
                }, 4500);
            };

            const handleClaimVoucher = async () => {
                if (balance < 5) return;
                const newCode = "TAKE-" + Math.random().toString(36).substring(2, 8).toUpperCase();
                const walletRef = doc(db, 'artifacts', appId, 'users', user.uid, 'data', 'wallet');
                try {
                    await updateDoc(walletRef, { balance: balance - 5, vouchers: arrayUnion(newCode) });
                    setLastClaimedCode(newCode);
                    setView('voucher_success');
                    showMsg("Voucher geclaimd!");
                } catch (e) {
                    showMsg("Fout bij claimen: " + e.message);
                }
            };

            const handleSecureAccount = async () => {
                const provider = new GoogleAuthProvider();
                try {
                    await linkWithPopup(auth.currentUser, provider);
                    setIsAnonymous(false);
                    showMsg("Account gekoppeld!");
                } catch (e) {
                    if (e.code === 'auth/unauthorized-domain') {
                        showMsg("Fout: Voeg '" + window.location.hostname + "' toe aan Authorized Domains in Firebase.");
                    } else { showMsg("Fout: " + e.message); }
                }
            };

            if (!user) return <div className="h-screen flex items-center justify-center font-black text-indigo-600 animate-pulse text-2xl">VIBECHECK</div>;

            return (
                <div className="app-container flex flex-col shadow-2xl">
                    {/* Header */}
                    <header className="pt-12 pb-4 px-6 bg-white border-b flex justify-between items-center z-30 shrink-0">
                        <div onClick={() => setView('landing')} className="flex items-center space-x-2 cursor-pointer">
                            <div className="w-8 h-8 bg-indigo-600 rounded-lg flex items-center justify-center text-white font-black text-xs">VB</div>
                            <h1 className="text-xl font-black tracking-tighter text-slate-900 italic">VIBECHECK</h1>
                        </div>
                        <div onClick={() => setView('wallet')} className="bg-emerald-50 text-emerald-700 px-4 py-1.5 rounded-full border border-emerald-100 flex items-center space-x-2 active:scale-95 transition-all">
                            <Icon name="wallet" size={16} />
                            <span className="font-bold text-sm">‚Ç¨{balance.toFixed(2)}</span>
                        </div>
                    </header>

                    {/* Main Content */}
                    <main className="flex-1 relative overflow-y-auto">
                        
                        {view === 'landing' && (
                            <div className="p-6 space-y-6 animate-fade-in">
                                <div className="bg-indigo-600 p-8 rounded-[2.5rem] text-white shadow-xl relative overflow-hidden card-shadow">
                                    <h2 className="text-2xl font-black mb-1 leading-tight uppercase">Swipe & Bespaar. üçø</h2>
                                    <p className="text-indigo-100 text-sm mb-6 font-medium leading-relaxed">Beslis samen wat jullie gaan doen en spaar direct voor korting op je eten.</p>
                                    <div className="grid grid-cols-2 gap-4">
                                        <button onClick={() => handleCreateRoom('food')} className="bg-white/10 p-5 rounded-2xl flex flex-col items-center font-bold active:bg-white/20 transition-all border border-white/10 vibe-card">
                                            <Icon name="utensils" className="mb-2" /> Eten
                                        </button>
                                        <button onClick={() => handleCreateRoom('movies')} className="bg-white/10 p-5 rounded-2xl flex flex-col items-center font-bold active:bg-white/20 transition-all border border-white/10 vibe-card">
                                            <Icon name="film" className="mb-2" /> Films
                                        </button>
                                    </div>
                                </div>

                                <div onClick={handleWatchAd} className="bg-white p-6 rounded-[2rem] flex items-center justify-between card-shadow border border-slate-100 active:scale-95 transition-all pulse-gold cursor-pointer">
                                    <div className="flex items-center space-x-4 text-left">
                                        <div className="w-12 h-12 bg-amber-100 rounded-2xl flex items-center justify-center text-amber-600">
                                            <Icon name="play" fill="currentColor" size={20} />
                                        </div>
                                        <div>
                                            <h3 className="font-bold text-sm">Snelle Bonus?</h3>
                                            <p className="text-[10px] text-slate-500 uppercase font-black">Kijk video voor ‚Ç¨0,15</p>
                                        </div>
                                    </div>
                                    <div className="bg-slate-900 text-white p-2 rounded-xl">
                                        <Icon name="chevronRight" size={20} />
                                    </div>
                                </div>

                                <div className="pt-4">
                                    <p className="text-[10px] font-black text-slate-400 uppercase tracking-[0.2em] text-center mb-4 leading-none italic">Of join een actieve kamer</p>
                                    <div className="flex space-x-2 bg-white p-2 rounded-2xl border border-slate-200 card-shadow">
                                        <input type="text" placeholder="CODE" className="flex-1 bg-transparent p-4 font-mono font-bold text-center outline-none uppercase" onChange={(e) => setRoomCode(e.target.value.toUpperCase())} />
                                        <button onClick={() => handleJoinRoom(roomCode)} className="bg-indigo-600 text-white px-8 rounded-xl font-bold active:scale-95 transition-all">OK</button>
                                    </div>
                                </div>
                            </div>
                        )}

                        {view === 'lobby' && (
                            <div className="p-6 flex flex-col items-center text-center space-y-8 animate-slide-up h-full">
                                <h2 className="text-3xl font-black mt-10">De Lobby</h2>
                                <div className="bg-white p-10 rounded-[3rem] border-4 border-dashed border-slate-200 card-shadow relative">
                                    <p className="text-5xl font-mono font-black text-indigo-600 tracking-widest">{roomCode}</p>
                                    <div onClick={() => {navigator.clipboard.writeText(roomCode); showMsg("Code gekopieerd!");}} className="absolute -bottom-5 -right-5 bg-slate-900 text-white p-4 rounded-full shadow-2xl active:scale-90 cursor-pointer transition-all">
                                        <Icon name="share" size={24} />
                                    </div>
                                </div>
                                <p className="text-slate-500 font-medium px-6 leading-relaxed">Deel de code met je vrienden. Zodra zij in de kamer zijn, kunnen we starten!</p>
                                <button onClick={() => setView('swiping')} className="w-full bg-indigo-600 text-white py-6 rounded-[2.5rem] text-xl font-black shadow-2xl active:scale-95 transition-all uppercase tracking-tight mt-auto">Start Swipen</button>
                            </div>
                        )}

                        {view === 'swiping' && roomData && (
                            <div className="p-4 h-full flex flex-col animate-fade-in">
                                <div className="flex-1 bg-white rounded-[3.5rem] card-shadow overflow-hidden flex flex-col border border-slate-100">
                                    <div className="h-[55%] w-full relative">
                                        <img src={roomData.items[currentIndex].img} className="h-full w-full object-cover" alt="Card" />
                                        <div className="absolute top-4 left-4 bg-black/30 backdrop-blur-md px-3 py-1 rounded-full text-white text-[10px] font-bold">
                                            {currentIndex + 1} / {roomData.items.length}
                                        </div>
                                    </div>
                                    <div className="p-8 text-center flex-1 flex flex-col justify-center">
                                        <h3 className="text-2xl font-black mb-2 text-slate-900 leading-tight">{roomData.items[currentIndex].name}</h3>
                                        <p className="text-slate-500 text-sm leading-relaxed px-4">{roomData.items[currentIndex].desc}</p>
                                    </div>
                                    <div className="p-8 flex justify-center space-x-8 pb-10">
                                        <button onClick={() => handleVote(false)} className="w-16 h-16 rounded-full bg-white border border-slate-100 text-rose-500 flex items-center justify-center shadow-xl active:scale-90 transition-all font-black text-2xl">‚úï</button>
                                        <button onClick={() => handleVote(true)} className="w-16 h-16 rounded-full bg-indigo-600 text-white flex items-center justify-center shadow-xl active:scale-90 transition-all font-black text-2xl italic">‚ô•</button>
                                    </div>
                                </div>
                            </div>
                        )}

                        {view === 'wallet' && (
                            <div className="p-6 space-y-6 animate-slide-up">
                                <div className="bg-white p-10 rounded-[3rem] card-shadow text-center border border-slate-100 relative overflow-hidden">
                                    <p className="text-[10px] font-black text-slate-400 uppercase tracking-widest mb-1 leading-none">Spaar-saldo</p>
                                    <h2 className="text-6xl font-black text-slate-900 tracking-tighter">‚Ç¨{balance.toFixed(2)}</h2>
                                    {balance < 5 && (
                                        <div className="mt-8 px-4">
                                            <div className="w-full h-3 bg-slate-100 rounded-full overflow-hidden">
                                                <div className="h-full bg-emerald-500 transition-all duration-700" style={{width: `${Math.min((balance/5)*100, 100)}%`}}></div>
                                            </div>
                                            <p className="text-[10px] text-slate-400 mt-4 font-bold uppercase tracking-tighter italic text-center">Nog ‚Ç¨{Math.max(5-balance, 0).toFixed(2)} tot je ‚Ç¨5 bon</p>
                                        </div>
                                    )}
                                </div>

                                <div className="bg-white p-5 rounded-3xl card-shadow border border-slate-100 flex items-center justify-between">
                                    <div className="flex items-center space-x-3 text-left">
                                        <div className={`p-2 rounded-xl ${isAnonymous ? 'bg-orange-50 text-orange-600' : 'bg-blue-50 text-blue-600'}`}>
                                            <Icon name={isAnonymous ? "lock" : "shield"} size={20} />
                                        </div>
                                        <div>
                                            <h4 className="text-sm font-bold leading-none">{isAnonymous ? "Onbeveiligd" : "Geverifieerd"}</h4>
                                            <p className="text-[9px] text-slate-400 mt-1">Koppel Google om nooit saldo te verliezen.</p>
                                        </div>
                                    </div>
                                    {isAnonymous && <button onClick={handleSecureAccount} className="bg-slate-900 text-white px-5 py-2 rounded-xl text-xs font-black active:scale-95 transition-all">KOPPEL</button>}
                                </div>

                                <div className="space-y-4 pt-4">
                                    <button onClick={handleClaimVoucher} disabled={balance < 5} className={`w-full p-6 rounded-[2rem] font-black border-4 flex items-center justify-center transition-all ${balance >= 5 ? 'bg-emerald-500 text-white border-emerald-400 shadow-xl active:scale-95' : 'bg-white text-slate-200 border-slate-100 cursor-not-allowed opacity-60'}`}>
                                        <Icon name="ticket" size={24} className="mr-3" /> Claim ‚Ç¨5 Voucher
                                    </button>
                                    
                                    <div className="space-y-2">
                                        <h3 className="text-[10px] font-black text-slate-400 uppercase tracking-widest px-2 text-left">Actieve Codes</h3>
                                        {vouchers.map((code, i) => (
                                            <div key={i} className="bg-slate-900 text-white p-5 rounded-2xl flex justify-between items-center card-shadow animate-fade-in border border-slate-800">
                                                <div className="text-left">
                                                    <p className="text-[8px] text-slate-400 uppercase font-black mb-1">Takeaway.com</p>
                                                    <span className="font-mono font-black text-amber-400 tracking-widest text-lg uppercase">{code}</span>
                                                </div>
                                                <button onClick={() => {navigator.clipboard.writeText(code); showMsg("Code gekopieerd!");}} className="bg-white/10 p-2 rounded-lg active:scale-90"><Icon name="share" size={16} /></button>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            </div>
                        )}

                        {view === 'match' && roomData && (
                            <div className="p-6 flex flex-col items-center text-center justify-center h-full space-y-8 animate-fade-in">
                                <div className="w-24 h-24 bg-amber-400 rounded-full flex items-center justify-center text-white card-shadow pulse-gold">
                                    <Icon name="award" size={48} />
                                </div>
                                <h2 className="text-6xl font-black italic tracking-tighter text-indigo-600 leading-none">MATCH!</h2>
                                <div className="bg-white p-2 rounded-[2.5rem] card-shadow transform rotate-1 border-2 border-amber-400 w-full overflow-hidden">
                                    {(() => {
                                        const votes = roomData.votes || {};
                                        const matchId = Object.keys(votes).find(id => votes[id].length === roomData.participants.length);
                                        const item = roomData.items.find(i => i.id === matchId) || roomData.items[0];
                                        return (
                                            <>
                                                <img src={item.img} className="h-64 w-full object-cover rounded-[2rem]" alt="Matched" />
                                                <div className="p-6">
                                                    <h3 className="text-2xl font-black text-slate-900 mb-2">{item.name}</h3>
                                                    <button className="w-full bg-emerald-500 text-white py-5 rounded-2xl font-black text-lg active:scale-95 transition-all shadow-xl uppercase italic">Korting Pakken</button>
                                                </div>
                                            </>
                                        );
                                    })()}
                                </div>
                                <button onClick={() => setView('landing')} className="text-slate-400 font-bold uppercase text-xs tracking-widest underline decoration-2 underline-offset-4">Nieuwe sessie</button>
                            </div>
                        )}

                        {view === 'voucher_success' && (
                            <div className="text-center space-y-8 py-10 animate-in zoom-in p-6">
                                <Icon name="check" size={64} className="mx-auto text-emerald-500 mb-4" />
                                <h2 className="text-3xl font-black tracking-tight text-indigo-600 uppercase italic">Code Ready!</h2>
                                <div className="bg-slate-900 text-white p-8 rounded-[2.5rem] shadow-2xl relative overflow-hidden">
                                    <p className="text-[10px] text-slate-400 uppercase mb-2 font-black tracking-[0.3em]">Jouw Voucher</p>
                                    <p className="text-4xl font-mono font-black text-yellow-400 tracking-widest uppercase select-all">{lastClaimedCode}</p>
                                    <div className="absolute -bottom-10 -right-10 w-32 h-32 bg-white/5 rounded-full"></div>
                                </div>
                                <button onClick={() => setView('wallet')} className="bg-indigo-50 text-indigo-600 px-8 py-4 rounded-2xl font-bold active:scale-95 transition-all shadow-md">Terug naar Wallet</button>
                            </div>
                        )}

                        {view === 'info' && (
                            <div className="p-6 space-y-6 animate-slide-up text-left">
                                <h2 className="text-3xl font-black italic tracking-tighter leading-none">Hulp & Info</h2>
                                <div className="bg-white p-6 rounded-3xl border border-slate-100 shadow-sm card-shadow">
                                    <h3 className="font-black text-indigo-600 mb-2 uppercase text-xs tracking-wider flex items-center">
                                        <Icon name="shield" size={16} className="mr-2"/> Privacy
                                    </h3>
                                    <p className="text-xs text-slate-500 leading-relaxed font-medium">VibeCheck respecteert jouw privacy. We verkopen je data nooit en gebruiken je voorkeuren alleen om relevante matches te tonen.</p>
                                </div>
                                <div className="bg-white p-6 rounded-3xl border border-slate-100 shadow-sm card-shadow">
                                    <h3 className="font-black text-emerald-600 mb-2 uppercase text-xs tracking-wider flex items-center">
                                        <Icon name="scale" size={16} className="mr-2"/> Voorwaarden
                                    </h3>
                                    <p className="text-xs text-slate-500 leading-relaxed font-medium">Punten zijn virtueel en uitsluitend inwisselbaar voor vouchers bij partners. Misbruik van het advertentiesysteem leidt tot uitsluiting.</p>
                                </div>
                                <div onClick={() => alert("Wissen bevestigen in instellingen van je telefoon...")} className="bg-red-50 p-6 rounded-3xl border border-red-100 flex justify-between items-center cursor-pointer active:scale-95 transition-transform shadow-sm">
                                    <span className="text-red-700 font-bold text-sm uppercase">Account Wissen</span>
                                    <Icon name="trash" size={20} className="text-red-400" />
                                </div>
                                <p className="text-center text-[10px] text-slate-300 font-bold uppercase mt-10 tracking-widest">VibeCheck Pro v1.0.5</p>
                            </div>
                        )}

                        {view === 'waiting' && (
                            <div className="h-full flex flex-col items-center justify-center text-center p-10 space-y-6 animate-pulse">
                                <div className="w-20 h-20 bg-indigo-50 rounded-full flex items-center justify-center text-indigo-600">
                                    <Icon name="heart" size={40} fill="currentColor" />
                                </div>
                                <h2 className="text-2xl font-black text-slate-800 leading-none uppercase">Wachten op de rest...</h2>
                                <p className="text-slate-400 text-sm px-6 font-medium leading-relaxed">Zodra iedereen zijn swipes heeft gedaan onthullen we de match!</p>
                            </div>
                        )}
                    </main>

                    {/* Bottom Nav */}
                    <footer className="absolute bottom-0 left-0 right-0 bg-white/90 backdrop-blur-xl border-t border-slate-100 px-6 py-4 flex justify-around items-center z-40 safe-bottom">
                        <button onClick={() => setView('landing')} className={`flex flex-col items-center space-y-1 transition-all ${['landing','swiping','lobby','waiting'].includes(view) ? 'text-indigo-600 scale-110' : 'text-slate-300'}`}>
                            <Icon name="heart" size={24} fill={['landing','swiping','lobby','waiting'].includes(view) ? "currentColor" : "none"} />
                            <span className="text-[10px] font-black uppercase tracking-tighter">Swipe</span>
                        </button>
                        <button onClick={() => setView('wallet')} className={`flex flex-col items-center space-y-1 transition-all ${['wallet','voucher_success'].includes(view) ? 'text-emerald-600 scale-110' : 'text-slate-300'}`}>
                            <Icon name="wallet" size={24} fill={['wallet','voucher_success'].includes(view) ? "currentColor" : "none"} />
                            <span className="text-[10px] font-black uppercase tracking-tighter">Wallet</span>
                        </button>
                        <button onClick={() => setView('info')} className={`flex flex-col items-center space-y-1 transition-all ${view === 'info' ? 'text-slate-900 scale-110' : 'text-slate-300'}`}>
                            <Icon name="info" size={24} fill={view === 'info' ? "currentColor" : "none"} />
                            <span className="text-[10px] font-black uppercase tracking-tighter">Info</span>
                        </button>
                    </footer>

                    {/* Toast Alert */}
                    {msg && (
                        <div className="fixed top-16 left-0 right-0 flex justify-center z-50 animate-slide-up pointer-events-none">
                            <div className="bg-slate-900 text-white px-6 py-3 rounded-2xl shadow-2xl text-xs font-black uppercase tracking-widest border border-white/10 mx-6">
                                {msg}
                            </div>
                        </div>
                    )}

                    {/* Video Overlay */}
                    {isWatchingAd && (
                        <div className="fixed inset-0 z-[100] bg-black flex flex-col items-center justify-center text-white p-10 animate-fade-in">
                            <div className="w-full max-w-xs flex flex-col items-center">
                                <div className="text-6xl mb-6 animate-bounce">üé¨</div>
                                <p className="text-xl font-black text-center mb-2 uppercase italic tracking-widest leading-none">Video Advertentie</p>
                                <p className="text-slate-400 text-xs text-center mb-10 px-4 leading-relaxed">Bedankt voor het kijken. Je saldo wordt verhoogd na deze advertentie.</p>
                                <div className="w-full h-2 bg-white/10 rounded-full overflow-hidden">
                                    <div className="h-full bg-indigo-500 animate-loading"></div>
                                </div>
                                <p className="mt-4 text-[10px] font-bold text-white/40 uppercase tracking-widest leading-none">Beloning: ‚Ç¨0,15</p>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>